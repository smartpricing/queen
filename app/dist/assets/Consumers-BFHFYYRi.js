import{h as c,c as v,l as W,a as r,b as t,d as C,t as o,u as p,f as m,n as h,A as L,B as U,k as b,L as E,C as H,F as M,j as S,D as z,x as j,o as n}from"./index-DukDhp_y.js";const O={class:"space-y-6 animate-fade-in"},I={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},J={class:"card p-4"},K={class:"text-2xl font-bold font-display text-light-900 dark:text-white mt-1"},P={class:"card p-4"},R={class:"text-2xl font-bold font-display text-cyber-600 dark:text-cyber-400 mt-1"},X={class:"card p-4"},Y={class:"text-2xl font-bold font-display text-crown-600 dark:text-crown-400 mt-1"},Z={class:"card p-4"},tt={class:"card p-4"},et={class:"flex flex-wrap items-center gap-4"},st={class:"flex-1 min-w-[200px] max-w-md"},lt={class:"relative"},ot={class:"flex items-center gap-2 text-sm text-light-700 dark:text-light-300"},at={class:"card overflow-hidden"},rt={class:"overflow-x-auto"},nt={class:"w-full"},it={key:0},dt={key:1},ut={class:"px-4 py-3"},ct={class:"font-medium text-light-900 dark:text-white"},xt={class:"px-4 py-3"},gt={class:"px-4 py-3"},pt={class:"text-sm text-crown-600 dark:text-crown-400"},mt={class:"px-4 py-3 text-right"},ht={class:"text-sm font-medium text-cyber-600 dark:text-cyber-400"},kt={class:"px-4 py-3 text-right"},vt={class:"text-sm text-light-700 dark:text-light-300"},bt={class:"px-4 py-3 text-right"},ft={class:"px-4 py-3"},wt={class:"flex items-center justify-center gap-1"},yt=["onClick"],_t=["onClick"],Ct={key:2},Lt={class:"card-header flex items-center justify-between"},Mt={class:"font-semibold text-light-900 dark:text-white"},St={class:"card-body overflow-y-auto max-h-[60vh]"},jt={class:"grid grid-cols-3 gap-4 mb-6"},At={class:"p-4 rounded-lg bg-light-100 dark:bg-dark-300 text-center"},Bt={class:"text-2xl font-bold text-cyber-600 dark:text-cyber-400 mt-1"},zt={class:"p-4 rounded-lg bg-light-100 dark:bg-dark-300 text-center"},Dt={class:"p-4 rounded-lg bg-light-100 dark:bg-dark-300 text-center"},Nt={class:"text-2xl font-bold text-light-900 dark:text-white mt-1"},Tt={class:"mb-4"},$t={class:"p-3 rounded-lg bg-light-100 dark:bg-dark-300"},qt={class:"font-medium text-light-900 dark:text-white"},Vt={key:0},Ft={class:"space-y-2"},Gt={class:"font-medium text-light-900 dark:text-white"},Qt=["onClick"],Wt={class:"text-light-600 dark:text-light-400 mb-6"},Ut={class:"flex items-center justify-end gap-3"},Ot={__name:"Consumers",setup(Et){const x=c([]),f=c(!0),k=c(""),w=c(!1),g=c("name"),a=c(null),d=c(null),A=v(()=>{let s=[...x.value];if(k.value){const e=k.value.toLowerCase();s=s.filter(i=>i.name.toLowerCase().includes(e))}return w.value&&(s=s.filter(e=>(e.totalLag||0)>100)),s.sort((e,i)=>g.value==="name"?e.name.localeCompare(i.name):g.value==="lag"?(i.totalLag||0)-(e.totalLag||0):g.value==="members"?(i.members||0)-(e.members||0):0),s}),D=v(()=>x.value.reduce((s,e)=>s+(e.members||0),0)),N=v(()=>x.value.reduce((s,e)=>s+(e.totalLag||0),0)),B=v(()=>x.value.filter(s=>(s.totalLag||0)>1e3).length),u=s=>{if(s.state)return s.state;const e=s.totalLag||0;return e>1e3?"Lagging":e>100?"Warning":"Stable"},T=s=>{const e=u(s);return e==="Lagging"?"bg-rose-100 dark:bg-rose-900/30 text-rose-700 dark:text-rose-400":e==="Warning"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400":"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400"},$=s=>{const e=u(s);return e==="Lagging"?"bg-rose-500":e==="Warning"?"bg-amber-500 animate-pulse":"bg-emerald-500"},y=async()=>{var s;f.value=!0;try{const e=await j.list();x.value=Array.isArray(e.data)?e.data:((s=e.data)==null?void 0:s.consumer_groups)||[]}catch(e){console.error("Failed to fetch consumers:",e)}finally{f.value=!1}},q=s=>{a.value=s},V=s=>{d.value=s},F=async()=>{if(d.value)try{await j.delete(d.value.name),d.value=null,y()}catch(s){console.error("Failed to delete consumer:",s)}},G=async(s,e)=>{try{await j.seek(s,e,{position:"latest"}),a.value=null,y()}catch(i){console.error("Failed to seek:",i)}};return W(y),(s,e)=>{var i;return n(),r("div",O,[t("div",I,[t("div",J,[e[9]||(e[9]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Total Groups",-1)),t("p",K,o(p(m)(x.value.length)),1)]),t("div",P,[e[10]||(e[10]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Active Consumers",-1)),t("p",R,o(p(m)(D.value)),1)]),t("div",X,[e[11]||(e[11]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Total Lag",-1)),t("p",Y,o(p(m)(N.value)),1)]),t("div",Z,[e[12]||(e[12]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Lagging Groups",-1)),t("p",{class:h(["text-2xl font-bold font-display mt-1",B.value>0?"text-rose-600 dark:text-rose-400":"text-emerald-600 dark:text-emerald-400"])},o(B.value),3)])]),t("div",tt,[t("div",et,[t("div",st,[t("div",lt,[L(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l),type:"text",placeholder:"Search consumer groups...",class:"input pl-10"},null,512),[[U,k.value]]),e[13]||(e[13]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-light-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1))])]),t("label",ot,[L(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>w.value=l),type:"checkbox",class:"w-4 h-4 rounded border-light-300 dark:border-dark-50 text-queen-500 focus:ring-queen-500"},null,512),[[E,w.value]]),e[14]||(e[14]=b(" Show lagging only ",-1))]),L(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),class:"select w-40"},[...e[15]||(e[15]=[t("option",{value:"name"},"Sort by Name",-1),t("option",{value:"lag"},"Sort by Lag",-1),t("option",{value:"members"},"Sort by Members",-1)])],512),[[H,g.value]])])]),t("div",at,[t("div",rt,[t("table",nt,[e[20]||(e[20]=t("thead",null,[t("tr",{class:"border-b border-light-200 dark:border-dark-50"},[t("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Group Name "),t("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Status "),t("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Queue "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Members "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Topics "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Lag "),t("th",{class:"text-center px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Actions ")])],-1)),f.value?(n(),r("tbody",it,[(n(),r(M,null,S(5,l=>t("tr",{key:l,class:"border-b border-light-100 dark:border-dark-100"},[...e[16]||(e[16]=[t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-40"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-5 w-16"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-24"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-8 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-8 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-20 mx-auto"})],-1)])])),64))])):A.value.length>0?(n(),r("tbody",dt,[(n(!0),r(M,null,S(A.value,l=>{var _;return n(),r("tr",{key:l.name,class:"border-b border-light-100 dark:border-dark-100 hover:bg-light-50 dark:hover:bg-dark-300 transition-colors"},[t("td",ut,[t("span",ct,o(l.name),1)]),t("td",xt,[t("span",{class:h(["inline-flex items-center gap-1.5 text-xs font-medium px-2 py-1 rounded-full",T(l)])},[t("span",{class:h(["w-1.5 h-1.5 rounded-full",$(l)])},null,2),b(" "+o(u(l)),1)],2)]),t("td",gt,[t("span",pt,o(l.queueName||"-"),1)]),t("td",mt,[t("span",ht,o(l.members||0),1)]),t("td",kt,[t("span",vt,o(((_=l.topics)==null?void 0:_.length)||0),1)]),t("td",bt,[t("span",{class:h(["text-sm font-medium",(l.totalLag||0)>1e3?"text-rose-600 dark:text-rose-400":(l.totalLag||0)>100?"text-amber-600 dark:text-amber-400":"text-light-900 dark:text-white"])},o(p(m)(l.totalLag||0)),3)]),t("td",ft,[t("div",wt,[t("button",{onClick:Q=>q(l),class:"p-1.5 rounded hover:bg-light-200 dark:hover:bg-dark-200 text-light-600 dark:text-light-400 hover:text-queen-600 dark:hover:text-queen-400 transition-colors",title:"View details"},[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,yt),t("button",{onClick:Q=>V(l),class:"p-1.5 rounded hover:bg-rose-100 dark:hover:bg-rose-900/30 text-light-600 dark:text-light-400 hover:text-rose-600 dark:hover:text-rose-400 transition-colors",title:"Delete group"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,_t)])])])}),128))])):(n(),r("tbody",Ct,[...e[19]||(e[19]=[t("tr",null,[t("td",{colspan:"7",class:"px-4 py-12 text-center"},[t("svg",{class:"w-12 h-12 mx-auto text-light-400 dark:text-light-600 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})]),t("h3",{class:"text-sm font-semibold text-light-900 dark:text-white mb-1"},"No consumer groups found"),t("p",{class:"text-sm text-light-600 dark:text-light-400"}," Consumer groups will appear here when clients connect ")])],-1)])]))])])]),a.value?(n(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-dark-500/50 backdrop-blur-sm",onClick:e[5]||(e[5]=l=>a.value=null)},[t("div",{class:"card w-full max-w-2xl max-h-[80vh] overflow-hidden animate-slide-up",onClick:e[4]||(e[4]=z(()=>{},["stop"]))},[t("div",Lt,[t("h3",Mt,o(a.value.name),1),t("button",{onClick:e[3]||(e[3]=l=>a.value=null),class:"btn btn-ghost btn-icon"},[...e[21]||(e[21]=[t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",St,[t("div",jt,[t("div",At,[e[22]||(e[22]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Members",-1)),t("p",Bt,o(a.value.members||0),1)]),t("div",zt,[e[23]||(e[23]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"State",-1)),t("p",{class:h(["text-lg font-bold mt-1",{"text-emerald-600 dark:text-emerald-400":u(a.value)==="Stable","text-amber-600 dark:text-amber-400":u(a.value)==="Warning","text-rose-600 dark:text-rose-400":u(a.value)==="Lagging"}])},o(u(a.value)),3)]),t("div",Dt,[e[24]||(e[24]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Lag",-1)),t("p",Nt,o(p(m)(a.value.totalLag||0)),1)])]),t("div",Tt,[e[25]||(e[25]=t("h4",{class:"text-sm font-medium text-light-700 dark:text-light-300 mb-2"},"Queue",-1)),t("div",$t,[t("span",qt,o(a.value.queueName||"-"),1)])]),((i=a.value.topics)==null?void 0:i.length)>0?(n(),r("div",Vt,[e[26]||(e[26]=t("h4",{class:"text-sm font-medium text-light-700 dark:text-light-300 mb-3"},"Topics",-1)),t("div",Ft,[(n(!0),r(M,null,S(a.value.topics,l=>(n(),r("div",{key:l,class:"flex items-center justify-between p-3 rounded-lg bg-light-100 dark:bg-dark-300"},[t("span",Gt,o(l),1),t("button",{onClick:_=>G(a.value.name,l),class:"btn btn-ghost text-xs"}," Seek ",8,Qt)]))),128))])])):C("",!0)])])])):C("",!0),d.value?(n(),r("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-dark-500/50 backdrop-blur-sm",onClick:e[8]||(e[8]=l=>d.value=null)},[t("div",{class:"card p-6 w-full max-w-md animate-slide-up",onClick:e[7]||(e[7]=z(()=>{},["stop"]))},[e[29]||(e[29]=t("h3",{class:"text-lg font-semibold text-light-900 dark:text-white mb-2"}," Delete Consumer Group ",-1)),t("p",Wt,[e[27]||(e[27]=b(" Are you sure you want to delete ",-1)),t("strong",null,o(d.value.name),1),e[28]||(e[28]=b("? This will disconnect all consumers in this group. ",-1))]),t("div",Ut,[t("button",{onClick:e[6]||(e[6]=l=>d.value=null),class:"btn btn-secondary"}," Cancel "),t("button",{onClick:F,class:"btn bg-rose-600 text-white hover:bg-rose-700"}," Delete ")])])])):C("",!0)])}}};export{Ot as default};
