import{h as d,c as J,l as O,G as K,I as W,a as n,d as u,b as t,t as a,A as I,B as X,C as B,F as k,j as q,J as Y,u as j,f as Z,n as P,K as A,k as V,v as tt,H as f,o as i}from"./index-DukDhp_y.js";const et={class:"space-y-6 animate-fade-in"},st={key:0,class:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-700/30 rounded-lg p-3"},lt={class:"flex items-center gap-2 text-sm"},at={class:"text-purple-700 dark:text-purple-300"},ot={class:"card p-4"},nt={class:"flex flex-wrap items-end gap-4"},it={class:"flex-1 min-w-[200px] max-w-sm"},rt={class:"relative"},dt={class:"w-48"},ut=["value"],ct={class:"w-40"},vt={class:"w-40"},xt={class:"card"},pt={class:"card-header flex items-center justify-between"},gt={class:"flex items-center gap-3"},mt={class:"badge badge-queen"},ht={class:"text-sm text-light-500"},bt={class:"overflow-x-auto"},kt={class:"table"},ft=["onClick"],yt={class:"text-sm font-medium text-light-900 dark:text-light-100"},wt={class:"text-xs text-light-500 dark:text-light-400 lg:hidden mt-0.5"},_t={class:"hidden xl:table-cell"},Ct={class:"text-xs text-light-600 dark:text-light-400 font-mono select-all break-all"},Mt={class:"hidden lg:table-cell"},It={class:"text-xs text-light-600 dark:text-light-400"},qt={class:"text-xs font-mono select-all break-all text-light-900 dark:text-light-100"},Dt={class:"text-right text-xs text-light-600 dark:text-light-400 tabular-nums whitespace-nowrap"},Lt={class:"text-right"},St={class:"flex flex-col items-end gap-1"},Bt={key:0,class:"text-xs text-light-600 dark:text-light-400"},jt={key:2},Pt={class:"px-5 py-4 border-t border-light-200 dark:border-dark-50 flex items-center justify-between"},Tt={class:"text-sm text-light-600 dark:text-light-400"},Qt={class:"flex gap-2"},At=["disabled"],Vt=["disabled"],Nt={key:1,class:"fixed inset-y-0 right-0 w-full max-w-lg bg-light-50 dark:bg-dark-400 shadow-2xl z-50 overflow-y-auto transform transition-transform duration-300 border-l border-light-200 dark:border-dark-50"},zt={class:"p-5"},Gt={class:"flex items-start justify-between mb-5 pb-4 border-b border-light-200 dark:border-dark-50"},Et={class:"flex-1 min-w-0"},Ft={class:"text-xs font-mono text-light-500 break-all"},Ht={key:0,class:"text-center py-12"},Ut={key:1,class:"text-sm text-rose-600 dark:text-rose-400"},Rt={class:"mb-6"},$t={class:"mb-5"},Jt={class:"space-y-4"},Ot={class:"text-sm font-medium text-light-900 dark:text-light-100"},Kt={class:"text-xs font-mono text-light-700 dark:text-light-300 break-all"},Wt={class:"text-xs font-mono text-light-700 dark:text-light-300 break-all"},Xt={class:"text-sm text-light-700 dark:text-light-300"},Yt={key:0},Zt={class:"text-xs font-mono break-all text-light-700 dark:text-light-300"},te={key:1},ee={class:"text-sm text-rose-600 dark:text-rose-400"},se={key:2},le={class:"text-sm text-light-700 dark:text-light-300"},ae={key:0,class:"mb-6"},oe={class:"bg-light-100 dark:bg-dark-300 rounded-lg p-4 grid grid-cols-2 gap-3 text-sm"},ne={class:"font-medium ml-1"},ie={class:"font-medium ml-1"},re={class:"font-medium ml-1"},de={class:"font-medium ml-1"},ue={class:"mb-4"},ce={class:"bg-light-100 dark:bg-dark-300 rounded-lg p-4 overflow-x-auto"},ve={class:"text-sm font-mono text-light-900 dark:text-light-100 whitespace-pre-wrap"},xe={key:1,class:"mb-6"},pe={class:"space-y-2"},ge={class:"text-sm font-medium"},me={class:"space-y-2 pt-2"},he={key:0,class:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-700/30 rounded-lg p-3 text-emerald-800 dark:text-emerald-200 text-sm"},be=["disabled"],ke=["disabled"],fe=["disabled"],ye={key:2,class:"text-sm text-rose-600 dark:text-rose-400 mt-4"},Ce={__name:"Messages",setup(we){const y=K(),w=d([]),T=d([]),_=d(null),D=d(!0),C=d(""),m=d(""),h=d(""),b=d(100),c=d(1),x=d(null),l=d(null),L=d(!1),M=d(null),v=d(!1),p=d(null),Q=J(()=>{let o=[...w.value];if(C.value){const e=C.value.toLowerCase();o=o.filter(r=>{var s,S;return((s=r.transactionId)==null?void 0:s.toLowerCase().includes(e))||((S=r.partitionId)==null?void 0:S.toLowerCase().includes(e))})}return o}),g=async()=>{var o,e;D.value=!0;try{const r={limit:b.value,offset:(c.value-1)*b.value};m.value&&(r.queue=m.value),h.value&&(r.status=h.value);const s=await f.list(r);w.value=((o=s.data)==null?void 0:o.messages)||[],_.value=((e=s.data)==null?void 0:e.mode)||null}catch(r){console.error("Failed to fetch messages:",r)}finally{D.value=!1}},N=async()=>{var o;try{const e=await tt.list();T.value=((o=e.data)==null?void 0:o.queues)||[]}catch(e){console.error("Failed to fetch queues:",e)}},z=()=>{c.value=1,g()},G=()=>{c.value>1&&(c.value--,g())},E=()=>{c.value++,g()},F=async o=>{var e,r;x.value=o,L.value=!0,M.value=null,l.value=null;try{const s=await f.get(o.partitionId,o.transactionId);l.value=s.data}catch(s){M.value=((r=(e=s.response)==null?void 0:e.data)==null?void 0:r.error)||s.message}finally{L.value=!1}},H=async()=>{var o,e;if(l.value){v.value=!0,p.value=null;try{await f.retry(l.value.partitionId,l.value.transactionId),x.value=null,g()}catch(r){p.value=((e=(o=r.response)==null?void 0:o.data)==null?void 0:e.error)||r.message}finally{v.value=!1}}},U=async()=>{var o,e;if(l.value){v.value=!0,p.value=null;try{await f.moveToDLQ(l.value.partitionId,l.value.transactionId),x.value=null,g()}catch(r){p.value=((e=(o=r.response)==null?void 0:o.data)==null?void 0:e.error)||r.message}finally{v.value=!1}}},R=async()=>{var o,e;if(l.value&&confirm("Are you sure you want to delete this message? This action cannot be undone.")){v.value=!0,p.value=null;try{await f.delete(l.value.partitionId,l.value.transactionId),x.value=null,g()}catch(r){p.value=((e=(o=r.response)==null?void 0:o.data)==null?void 0:e.error)||r.message}finally{v.value=!1}}},$=o=>{if(!o)return"null";if(typeof o=="string")try{return JSON.stringify(JSON.parse(o),null,2)}catch{return o}return JSON.stringify(o,null,2)};return O(()=>{y.query.queue&&(m.value=y.query.queue),y.query.status&&(h.value=y.query.status),N(),g()}),W([m,h],()=>{c.value=1,g()}),(o,e)=>{var r;return i(),n("div",et,[_.value&&_.value.type==="bus"?(i(),n("div",st,[t("div",lt,[e[6]||(e[6]=t("svg",{class:"w-5 h-5 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e[7]||(e[7]=t("span",{class:"font-medium text-purple-900 dark:text-purple-100"},"Bus Mode Active",-1)),t("span",at,a(_.value.busGroupsCount)+" consumer group(s)",1)])])):u("",!0),t("div",ot,[t("div",nt,[t("div",it,[e[9]||(e[9]=t("label",{class:"block text-xs font-medium text-light-600 dark:text-light-400 mb-1.5"}," Search ",-1)),t("div",rt,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>C.value=s),type:"text",placeholder:"Search by transaction ID...",class:"input pl-10"},null,512),[[X,C.value]]),e[8]||(e[8]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-light-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1))])]),t("div",dt,[e[11]||(e[11]=t("label",{class:"block text-xs font-medium text-light-600 dark:text-light-400 mb-1.5"}," Queue ",-1)),I(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),class:"select"},[e[10]||(e[10]=t("option",{value:""},"All Queues",-1)),(i(!0),n(k,null,q(T.value,s=>(i(),n("option",{key:s.name,value:s.name},a(s.name),9,ut))),128))],512),[[B,m.value]])]),t("div",ct,[e[13]||(e[13]=t("label",{class:"block text-xs font-medium text-light-600 dark:text-light-400 mb-1.5"}," Status ",-1)),I(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),class:"select"},[...e[12]||(e[12]=[Y('<option value="">All Status</option><option value="pending">Pending</option><option value="processing">Processing</option><option value="completed">Completed</option><option value="dead_letter">Dead Letter</option>',5)])],512),[[B,h.value]])]),t("div",vt,[e[15]||(e[15]=t("label",{class:"block text-xs font-medium text-light-600 dark:text-light-400 mb-1.5"}," Limit ",-1)),I(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),class:"select"},[...e[14]||(e[14]=[t("option",{value:50},"50 messages",-1),t("option",{value:100},"100 messages",-1),t("option",{value:200},"200 messages",-1),t("option",{value:500},"500 messages",-1)])],512),[[B,b.value]])]),t("button",{onClick:z,class:"btn btn-cyber"}," Apply Filters ")])]),t("div",xt,[t("div",pt,[t("div",gt,[e[16]||(e[16]=t("h3",{class:"font-semibold text-light-900 dark:text-white"},"Messages",-1)),t("span",mt,a(j(Z)(w.value.length))+" loaded",1)]),t("div",ht," Page "+a(c.value),1)]),t("div",bt,[t("table",kt,[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",null,"Queue"),t("th",{class:"hidden xl:table-cell"},"Partition ID"),t("th",{class:"hidden lg:table-cell"},"Partition"),t("th",null,"Transaction ID"),t("th",{class:"text-right"},"Created"),t("th",{class:"text-right"},"Status")])],-1)),t("tbody",null,[D.value?(i(),n(k,{key:0},q(10,s=>t("tr",{key:s},[...e[17]||(e[17]=[t("td",null,[t("div",{class:"skeleton h-4 w-24"})],-1),t("td",{class:"hidden xl:table-cell"},[t("div",{class:"skeleton h-4 w-32"})],-1),t("td",{class:"hidden lg:table-cell"},[t("div",{class:"skeleton h-4 w-12"})],-1),t("td",null,[t("div",{class:"skeleton h-4 w-40"})],-1),t("td",null,[t("div",{class:"skeleton h-4 w-28"})],-1),t("td",null,[t("div",{class:"skeleton h-4 w-20"})],-1)])])),64)):Q.value.length>0?(i(!0),n(k,{key:1},q(Q.value,s=>(i(),n("tr",{key:s.id,class:"group cursor-pointer hover:bg-queen-50 dark:hover:bg-queen-500/10",onClick:S=>F(s)},[t("td",null,[t("div",yt,a(s.queue),1),t("div",wt,a(s.partition),1)]),t("td",_t,[t("div",Ct,a(s.partitionId),1)]),t("td",Mt,[t("span",It,a(s.partition),1)]),t("td",null,[t("div",qt,a(s.transactionId),1)]),t("td",Dt,a(j(A)(s.createdAt)),1),t("td",Lt,[t("div",St,[t("span",{class:P(["badge",{"badge-cyber":s.status==="pending","badge-crown":s.status==="processing","badge-success":s.status==="completed","badge-danger":s.status==="dead_letter"||s.status==="failed"}])},a(s.status),3),s.busStatus&&s.busStatus.totalGroups>0?(i(),n("div",Bt,a(s.busStatus.consumedBy)+"/"+a(s.busStatus.totalGroups)+" groups ",1)):u("",!0)])])],8,ft))),128)):(i(),n("tr",jt,[...e[18]||(e[18]=[t("td",{colspan:"6",class:"text-center py-12"},[t("svg",{class:"w-12 h-12 mx-auto text-light-400 dark:text-light-600 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})]),t("p",{class:"text-light-600 dark:text-light-400"},"No messages found")],-1)])]))])])]),t("div",Pt,[t("div",Tt," Page "+a(c.value),1),t("div",Qt,[t("button",{onClick:G,disabled:c.value===1,class:"btn btn-secondary px-3 py-1.5"},[...e[20]||(e[20]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,At),t("button",{onClick:E,disabled:w.value.length<b.value,class:"btn btn-secondary px-3 py-1.5"},[...e[21]||(e[21]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Vt)])])]),x.value?(i(),n("div",Nt,[t("div",zt,[t("div",Gt,[t("div",Et,[e[22]||(e[22]=t("h3",{class:"text-base font-bold mb-1 text-light-900 dark:text-white"},"Message Details",-1)),t("p",Ft,a((r=l.value)==null?void 0:r.transactionId),1)]),t("button",{onClick:e[4]||(e[4]=s=>x.value=null),class:"text-light-400 hover:text-light-600 dark:hover:text-light-300 p-1.5 rounded-lg hover:bg-light-100 dark:hover:bg-dark-300 transition-colors"},[...e[23]||(e[23]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),L.value?(i(),n("div",Ht,[...e[24]||(e[24]=[t("div",{class:"w-8 h-8 border-2 border-queen-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"},null,-1),t("p",{class:"text-light-500"},"Loading details...",-1)])])):M.value?(i(),n("div",Ut,a(M.value),1)):l.value?(i(),n(k,{key:2},[t("div",Rt,[t("div",$t,[t("span",{class:P(["badge text-sm",{"badge-cyber":l.value.status==="pending","badge-crown":l.value.status==="processing","badge-success":l.value.status==="completed","badge-danger":l.value.status==="dead_letter"||l.value.status==="failed"}])},a(l.value.status),3)]),t("div",Jt,[t("div",null,[e[25]||(e[25]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Queue / Partition",-1)),t("p",Ot,a(l.value.queue)+" / "+a(l.value.partition),1)]),t("div",null,[e[26]||(e[26]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Partition ID",-1)),t("p",Kt,a(l.value.partitionId),1)]),t("div",null,[e[27]||(e[27]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Transaction ID",-1)),t("p",Wt,a(l.value.transactionId),1)]),t("div",null,[e[28]||(e[28]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Created",-1)),t("p",Xt,a(j(A)(l.value.createdAt)),1)]),l.value.traceId?(i(),n("div",Yt,[e[29]||(e[29]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Trace ID",-1)),t("p",Zt,a(l.value.traceId),1)])):u("",!0),l.value.errorMessage?(i(),n("div",te,[e[30]||(e[30]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Error Message",-1)),t("p",ee,a(l.value.errorMessage),1)])):u("",!0),l.value.retryCount?(i(),n("div",se,[e[31]||(e[31]=t("label",{class:"text-xs font-medium text-light-500 block mb-1.5 uppercase tracking-wide"},"Retry Count",-1)),t("p",le,a(l.value.retryCount),1)])):u("",!0)])]),l.value.queueConfig?(i(),n("div",ae,[e[36]||(e[36]=t("h4",{class:"text-sm font-semibold mb-3 text-light-900 dark:text-white"},"Queue Config",-1)),t("div",oe,[t("div",null,[e[32]||(e[32]=t("span",{class:"text-light-500"},"Lease Time:",-1)),t("span",ne,a(l.value.queueConfig.leaseTime)+"s",1)]),t("div",null,[e[33]||(e[33]=t("span",{class:"text-light-500"},"TTL:",-1)),t("span",ie,a(l.value.queueConfig.ttl)+"s",1)]),t("div",null,[e[34]||(e[34]=t("span",{class:"text-light-500"},"Retry Limit:",-1)),t("span",re,a(l.value.queueConfig.retryLimit),1)]),t("div",null,[e[35]||(e[35]=t("span",{class:"text-light-500"},"Retry Delay:",-1)),t("span",de,a(l.value.queueConfig.retryDelay)+"ms",1)])])])):u("",!0),t("div",ue,[e[37]||(e[37]=t("h4",{class:"text-sm font-semibold mb-3 text-light-900 dark:text-white"},"Payload",-1)),t("div",ce,[t("pre",ve,a($(l.value.payload)),1)])]),l.value.consumerGroups&&l.value.consumerGroups.length>0?(i(),n("div",xe,[e[38]||(e[38]=t("h4",{class:"text-sm font-semibold mb-3 text-light-900 dark:text-white"},"Consumer Groups",-1)),t("div",pe,[(i(!0),n(k,null,q(l.value.consumerGroups,s=>(i(),n("div",{key:s.name,class:"flex items-center justify-between p-3 bg-light-100 dark:bg-dark-300 rounded-lg"},[t("span",ge,a(s.name==="__QUEUE_MODE__"?"Queue Mode":s.name),1),t("span",{class:P(["badge",s.consumed?"badge-success":"badge-cyber"])},a(s.consumed?"Consumed":"Pending"),3)]))),128))])])):u("",!0),t("div",me,[l.value.status==="completed"?(i(),n("div",he,[...e[39]||(e[39]=[t("div",{class:"flex gap-2"},[t("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("p",null,"This message has been successfully consumed and acknowledged.")],-1)])])):u("",!0),l.value.status==="dead_letter"?(i(),n("button",{key:1,onClick:H,disabled:v.value,class:"btn btn-primary w-full"},[...e[40]||(e[40]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),V(" Retry Message ",-1)])],8,be)):u("",!0),l.value.status==="pending"?(i(),n("button",{key:2,onClick:U,disabled:v.value,class:"btn btn-secondary w-full"}," Move to Dead Letter Queue ",8,ke)):u("",!0),t("button",{onClick:R,disabled:v.value,class:"btn bg-rose-600 text-white hover:bg-rose-700 w-full"},[...e[41]||(e[41]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),V(" Delete Message ",-1)])],8,fe)]),p.value?(i(),n("div",ye,a(p.value),1)):u("",!0)],64)):u("",!0)])])):u("",!0),x.value?(i(),n("div",{key:2,class:"fixed inset-0 bg-dark-500/50 backdrop-blur-sm z-40",onClick:e[5]||(e[5]=s=>x.value=null)})):u("",!0)])}}};export{Ce as default};
