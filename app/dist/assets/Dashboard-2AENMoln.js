import{c as $,f as N,a as r,o as l,b as e,d as M,t as u,n as v,e as U,r as ie,g as Y,h as p,i as W,u as A,F as V,j as L,k as R,l as ue,m as ce,p as F,w as z,q as de,s as ge,v as he,x as ve,y as me,z as I}from"./index-DukDhp_y.js";import{_ as be}from"./BaseChart-7Qv702xa.js";const fe={class:"flex items-start justify-between"},pe={class:"metric-label"},ke={key:0,class:"skeleton w-20 h-8"},ye={key:1},xe={key:0,class:"text-xs text-light-500 dark:text-light-500 mt-1"},we={key:0,class:"flex-shrink-0"},$e={key:0,class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Ce={key:1,class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Se={key:0,class:"mt-4"},qe={class:"flex items-center justify-between text-xs text-light-500 mb-1"},Me={class:"h-1.5 bg-light-200 dark:bg-dark-100 rounded-full overflow-hidden"},Q={__name:"MetricCard",props:{label:{type:String,required:!0},value:{type:[Number,String],default:0},format:{type:String,default:"number"},subtext:{type:String,default:null},icon:{type:[Object,Function],default:null},iconColor:{type:String,default:"queen"},trend:{type:Number,default:null},progress:{type:Number,default:null},progressLabel:{type:String,default:"Progress"},progressColor:{type:String,default:"queen"},loading:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1}},emits:["click"],setup(a){const o=a,d=$(()=>{if(o.value===null||o.value===void 0)return"-";switch(o.format){case"number":return N(o.value);case"percent":return`${o.value}%`;case"duration":return o.value;default:return o.value}}),k=$(()=>{const c={queen:"text-queen-600 dark:text-queen-400",cyber:"text-cyber-600 dark:text-cyber-400",crown:"text-crown-600 dark:text-crown-400"};return o.iconColor?c[o.iconColor]:""}),y=$(()=>{const c={queen:"bg-queen-100 dark:bg-queen-500/20",cyber:"bg-cyber-100 dark:bg-cyber-500/20",crown:"bg-crown-100 dark:bg-crown-500/20"};return c[o.iconColor]||c.queen}),D=$(()=>{const c={queen:"text-queen-600 dark:text-queen-400",cyber:"text-cyber-600 dark:text-cyber-400",crown:"text-crown-600 dark:text-crown-400"};return c[o.iconColor]||c.queen}),m=$(()=>{const c={queen:"bg-gradient-to-r from-queen-500 to-queen-600",cyber:"bg-gradient-to-r from-cyber-500 to-cyber-600",crown:"bg-gradient-to-r from-crown-500 to-crown-600"};return c[o.progressColor]||c.queen});return(c,f)=>(l(),r("div",{class:v(["metric-card group cursor-pointer",{"hover:shadow-glow-queen":a.clickable}]),onClick:f[0]||(f[0]=P=>c.$emit("click"))},[e("div",fe,[e("div",null,[e("p",pe,u(a.label),1),e("p",{class:v(["metric-value mt-1",k.value])},[a.loading?(l(),r("span",ke)):(l(),r("span",ye,u(d.value),1))],2),a.subtext?(l(),r("p",xe,u(a.subtext),1)):M("",!0)]),a.icon||a.trend!==null?(l(),r("div",we,[a.icon?(l(),r("div",{key:0,class:v(["w-12 h-12 rounded-xl flex items-center justify-center",y.value])},[(l(),U(ie(a.icon),{class:v(["w-6 h-6",D.value])},null,8,["class"]))],2)):a.trend!==null?(l(),r("div",{key:1,class:v(["flex items-center gap-1 metric-change",a.trend>=0?"metric-change-up":"metric-change-down"])},[a.trend>=0?(l(),r("svg",$e,[...f[1]||(f[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 11l5-5m0 0l5 5m-5-5v12"},null,-1)])])):(l(),r("svg",Ce,[...f[2]||(f[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17 13l-5 5m0 0l-5-5m5 5V6"},null,-1)])])),e("span",null,u(Math.abs(a.trend))+"%",1)],2)):M("",!0)])):M("",!0)]),a.progress!==null?(l(),r("div",Se,[e("div",qe,[e("span",null,u(a.progressLabel),1),e("span",null,u(a.progress)+"%",1)]),e("div",Me,[e("div",{class:v(["h-full rounded-full transition-all duration-500",m.value]),style:Y({width:`${a.progress}%`})},null,6)])])):M("",!0)],2))}},_e={class:"card overflow-hidden"},De={key:0,class:"card-header flex items-center justify-between"},Be={class:"flex items-center gap-3"},je={key:0,class:"font-semibold text-light-900 dark:text-white"},ze={key:1,class:"badge badge-queen"},Ne={class:"table-container"},Ae={class:"table"},Ve=["onClick"],Le=["onClick"],Pe={key:2},Fe=["colspan"],Ie={class:"text-light-500 dark:text-light-500"},Oe={class:"text-sm"},Te={key:1,class:"px-5 py-4 border-t border-light-200 dark:border-dark-50 flex items-center justify-between"},Qe={class:"text-sm text-light-600 dark:text-light-400"},Re={class:"flex items-center gap-2"},He=["disabled"],Ue=["disabled"],X={__name:"DataTable",props:{columns:{type:Array,required:!0},data:{type:Array,default:()=>[]},title:{type:String,default:null},total:{type:Number,default:null},loading:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},pagination:{type:Boolean,default:!0},pageSize:{type:Number,default:10},emptyText:{type:String,default:"No data available"},defaultSort:{type:String,default:null},defaultSortOrder:{type:String,default:"asc"}},emits:["row-click"],setup(a){const o=a,d=p(1),k=p(o.defaultSort),y=p(o.defaultSortOrder),D=(g,h)=>h.split(".").reduce((i,x)=>i==null?void 0:i[x],g),m=$(()=>k.value?[...o.data].sort((g,h)=>{const i=D(g,k.value),x=D(h,k.value);if(i===x)return 0;const C=i<x?-1:1;return y.value==="asc"?C:-C}):o.data),c=$(()=>Math.ceil(m.value.length/o.pageSize)),f=$(()=>{if(!o.pagination)return m.value;const g=(d.value-1)*o.pageSize;return m.value.slice(g,g+o.pageSize)}),P=g=>{k.value===g?y.value=y.value==="asc"?"desc":"asc":(k.value=g,y.value="asc"),d.value=1};return(g,h)=>(l(),r("div",_e,[a.title||g.$slots.header?(l(),r("div",De,[e("div",Be,[a.title?(l(),r("h3",je,u(a.title),1)):M("",!0),a.total?(l(),r("span",ze,u(A(N)(a.total))+" total ",1)):M("",!0)]),W(g.$slots,"header")])):M("",!0),e("div",Ne,[e("table",Ae,[e("thead",null,[e("tr",null,[(l(!0),r(V,null,L(a.columns,i=>(l(),r("th",{key:i.key,class:v([i.align==="right"?"text-right":"",i.sortable?"cursor-pointer hover:text-queen-600 dark:hover:text-queen-400 select-none":""]),onClick:x=>i.sortable&&P(i.key)},[e("div",{class:v(["flex items-center gap-1.5",{"justify-end":i.align==="right"}])},[R(u(i.label)+" ",1),i.sortable&&k.value===i.key?(l(),r("svg",{key:0,class:v(["w-3.5 h-3.5 transition-transform",{"rotate-180":y.value==="desc"}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[...h[2]||(h[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 15l7-7 7 7"},null,-1)])],2)):M("",!0)],2)],10,Ve))),128))])]),e("tbody",null,[a.loading?(l(),r(V,{key:0},L(5,i=>e("tr",{key:i},[(l(!0),r(V,null,L(a.columns,x=>(l(),r("td",{key:x.key},[...h[3]||(h[3]=[e("div",{class:"skeleton h-4 w-24"},null,-1)])]))),128))])),64)):m.value.length>0?(l(!0),r(V,{key:1},L(f.value,(i,x)=>(l(),r("tr",{key:i.id||x,class:v(["transition-colors",{"cursor-pointer":a.clickable}]),onClick:C=>a.clickable&&g.$emit("row-click",i)},[(l(!0),r(V,null,L(a.columns,C=>(l(),r("td",{key:C.key,class:v(C.align==="right"?"text-right":"")},[W(g.$slots,C.key,{row:i,value:D(i,C.key)},()=>[R(u(D(i,C.key)),1)])],2))),128))],10,Le))),128)):(l(),r("tr",Pe,[e("td",{colspan:a.columns.length,class:"text-center py-12"},[e("div",Ie,[h[4]||(h[4]=e("svg",{class:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1)),e("p",Oe,u(a.emptyText),1)])],8,Fe)]))])])]),a.pagination&&m.value.length>a.pageSize?(l(),r("div",Te,[e("p",Qe," Showing "+u((d.value-1)*a.pageSize+1)+" to "+u(Math.min(d.value*a.pageSize,m.value.length))+" of "+u(m.value.length),1),e("div",Re,[e("button",{onClick:h[0]||(h[0]=i=>d.value--),disabled:d.value===1,class:"btn btn-secondary px-3 py-1.5 text-sm disabled:opacity-50"}," Previous ",8,He),e("button",{onClick:h[1]||(h[1]=i=>d.value++),disabled:d.value>=c.value,class:"btn btn-secondary px-3 py-1.5 text-sm disabled:opacity-50"}," Next ",8,Ue)])])):M("",!0)]))}},Ge={class:"space-y-6 animate-fade-in"},Ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5"},Ke={class:"grid grid-cols-1 lg:grid-cols-3 gap-5"},Je={class:"lg:col-span-2 card"},We={class:"card-header flex items-center justify-between"},Xe={class:"flex items-center gap-2"},Ye=["onClick"],Ze={class:"card-body"},et={key:1,class:"h-[280px] flex items-center justify-center"},tt={class:"card"},st={class:"card-body"},at={key:0,class:"space-y-4"},lt={class:"flex items-center justify-between text-sm mb-1.5"},nt={class:"font-medium text-light-800 dark:text-light-200 truncate max-w-[150px]"},rt={class:"text-light-600 dark:text-light-400 tabular-nums"},ot={class:"h-2 bg-light-200 dark:bg-dark-100 rounded-full overflow-hidden"},it={key:1,class:"h-[200px] flex items-center justify-center text-light-500 text-sm"},ut={class:"grid grid-cols-1 lg:grid-cols-2 gap-5"},ct={class:"font-medium text-light-900 dark:text-white"},dt={class:"badge badge-cyber"},gt={class:"badge badge-crown"},ht={class:"font-medium text-light-900 dark:text-white truncate max-w-[180px]"},vt={class:"badge badge-queen"},ft={__name:"Dashboard",setup(a){const o=p(null),d=p([]),k=p([]),y=p(null),D=p(new Date),m=p(!0),c=p(!0),f=p(!0),P=p(!0),g=p("1h"),h=[{label:"1h",value:"1h"},{label:"6h",value:"6h"},{label:"24h",value:"24h"}],i=$(()=>d.value.reduce((t,s)=>t+(s.partitions||1),0)),x=$(()=>{var s;return(s=o.value)!=null&&s.throughput?{current:(o.value.throughput.ingestedPerSecond||o.value.throughput.processedPerSecond||0).toFixed(1),trend:0}:{current:"0",trend:0}}),C=(t,s)=>s?t.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),G=$(()=>{var w;if(!((w=y.value)!=null&&w.throughput)||!Array.isArray(y.value.throughput))return{labels:[],datasets:[]};const t=[...y.value.throughput].reverse();let s=!1;if(t.length>1){const b=new Date(t[0].timestamp),q=new Date(t[t.length-1].timestamp);s=b.toDateString()!==q.toDateString()}return{labels:t.map(b=>{const q=new Date(b.timestamp);return C(q,s)}),datasets:[{label:"Messages In",data:t.map(b=>b.ingested||0),fill:!0},{label:"Messages Out",data:t.map(b=>b.processed||0),fill:!0}]}}),T=$(()=>{if(!d.value.length)return[];const t=d.value.reduce((S,w)=>{var B,j;const b=((B=w.messages)==null?void 0:B.pending)||0,q=((j=w.messages)==null?void 0:j.processing)||0;return S+b+q},0),s=["bg-gradient-to-r from-queen-500 to-queen-600","bg-gradient-to-r from-cyber-500 to-cyber-600","bg-gradient-to-r from-crown-500 to-crown-600","bg-gradient-to-r from-emerald-500 to-emerald-600","bg-gradient-to-r from-violet-500 to-violet-600"];return d.value.map((S,w)=>{var j,O;const b=((j=S.messages)==null?void 0:j.pending)||0,q=((O=S.messages)==null?void 0:O.processing)||0,B=b+q;return{name:S.name,count:B,percentage:t>0?B/t*100:0,colorClass:s[w%s.length]}}).sort((S,w)=>w.count-S.count)}),Z=[{key:"name",label:"Queue Name",sortable:!0},{key:"messages.pending",label:"Pending",sortable:!0,align:"right"},{key:"messages.processing",label:"Processing",sortable:!0,align:"right"},{key:"status",label:"Status"}],ee=[{key:"name",label:"Group Name",sortable:!0},{key:"members",label:"Members",sortable:!0,align:"right"},{key:"totalLag",label:"Lag",sortable:!0,align:"right"}],te=async()=>{m.value=!0;try{const t=await ge.getOverview();o.value=t.data}catch(t){console.error("Failed to fetch overview:",t)}finally{m.value=!1}},se=async()=>{var t;c.value=!0;try{const s=await he.list();d.value=((t=s.data)==null?void 0:t.queues)||s.data||[]}catch(s){console.error("Failed to fetch queues:",s)}finally{c.value=!1}},ae=async()=>{var t;f.value=!0;try{const s=await ve.list();k.value=Array.isArray(s.data)?s.data:((t=s.data)==null?void 0:t.consumer_groups)||[]}catch(s){console.error("Failed to fetch consumers:",s)}finally{f.value=!1}},le=async()=>{P.value=!0;try{const t=await me.getStatus({history:60});y.value=t.data}catch(t){console.error("Failed to fetch status:",t)}finally{P.value=!1}},E=async()=>{D.value=new Date,await Promise.all([te(),se(),ae(),le()])};let H=null;ue(()=>{E(),H=setInterval(E,3e4)}),ce(()=>{H&&clearInterval(H)});function ne(t){return I("svg",{...t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[I("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})])}function re(t){return I("svg",{...t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[I("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})])}function oe(t){return I("svg",{...t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[I("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})])}return(t,s)=>{var w,b,q,B,j,O;const S=de("router-link");return l(),r("div",Ge,[e("div",Ee,[F(Q,{label:"Total Queues",value:((w=o.value)==null?void 0:w.queues)||0,subtext:`${A(N)(i.value)} partitions`,icon:ne,"icon-color":"queen",loading:m.value,clickable:"",onClick:s[0]||(s[0]=n=>t.$router.push("/queues"))},null,8,["value","subtext","loading"]),F(Q,{label:"Total Messages",value:((q=(b=o.value)==null?void 0:b.messages)==null?void 0:q.total)||0,subtext:`${A(N)(((j=(B=o.value)==null?void 0:B.messages)==null?void 0:j.completed)||0)} completed`,icon:re,"icon-color":"cyber",loading:m.value,clickable:"",onClick:s[1]||(s[1]=n=>t.$router.push("/messages"))},null,8,["value","subtext","loading"]),F(Q,{label:"Consumer Groups",value:((O=k.value)==null?void 0:O.length)||0,icon:oe,"icon-color":"crown",loading:f.value,clickable:"",onClick:s[2]||(s[2]=n=>t.$router.push("/consumers"))},null,8,["value","loading"]),F(Q,{label:"Processing Rate",value:x.value.current,format:"raw",subtext:"messages/sec",trend:x.value.trend,loading:P.value},null,8,["value","trend","loading"])]),e("div",Ke,[e("div",Je,[e("div",We,[s[5]||(s[5]=e("div",null,[e("h3",{class:"font-semibold text-light-900 dark:text-white"},"Throughput"),e("p",{class:"text-xs text-light-500 mt-0.5"},"Messages processed over time")],-1)),e("div",Xe,[(l(),r(V,null,L(h,n=>e("button",{key:n.value,onClick:_=>g.value=n.value,class:v(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",g.value===n.value?"bg-queen-500 text-white":"text-light-600 dark:text-light-400 hover:bg-light-200 dark:hover:bg-dark-100"])},u(n.label),11,Ye)),64))])]),e("div",Ze,[G.value.labels.length>0?(l(),U(be,{key:0,type:"line",data:G.value,height:"280px"},null,8,["data"])):(l(),r("div",et,[...s[6]||(s[6]=[e("div",{class:"text-center text-light-500"},[e("div",{class:"spinner mx-auto mb-3"}),e("p",{class:"text-sm"},"Loading chart data...")],-1)])]))])]),e("div",tt,[s[8]||(s[8]=e("div",{class:"card-header"},[e("h3",{class:"font-semibold text-light-900 dark:text-white"},"Queue Distribution"),e("p",{class:"text-xs text-light-500 mt-0.5"},"Messages per queue")],-1)),e("div",st,[T.value.length>0?(l(),r("div",at,[(l(!0),r(V,null,L(T.value.slice(0,5),n=>(l(),r("div",{key:n.name,class:"group"},[e("div",lt,[e("span",nt,u(n.name),1),e("span",rt,u(A(N)(n.count)),1)]),e("div",ot,[e("div",{class:v(["h-full rounded-full transition-all duration-500 group-hover:opacity-80",n.colorClass]),style:Y({width:`${n.percentage}%`})},null,6)])]))),128)),T.value.length>5?(l(),U(S,{key:0,to:"/queues",class:"inline-flex items-center gap-1 text-sm text-queen-600 dark:text-queen-400 hover:underline mt-2"},{default:z(()=>[R(" View all "+u(T.value.length)+" queues ",1),s[7]||(s[7]=e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1))]),_:1})):M("",!0)])):(l(),r("div",it," No queues found "))])])]),e("div",ut,[F(X,{title:"Active Queues",columns:Z,data:d.value,loading:c.value,"page-size":5,clickable:"",onRowClick:s[3]||(s[3]=n=>t.$router.push(`/queues/${n.name}`))},{name:z(({value:n})=>[e("span",ct,u(n),1)]),"messages.pending":z(({row:n})=>{var _;return[e("span",dt,u(A(N)(((_=n.messages)==null?void 0:_.pending)||0)),1)]}),"messages.processing":z(({row:n})=>{var _;return[e("span",gt,u(A(N)(((_=n.messages)==null?void 0:_.processing)||0)),1)]}),status:z(({row:n})=>{var _,K,J;return[e("span",{class:v(["inline-flex items-center gap-1.5",(((_=n.messages)==null?void 0:_.processing)||0)>0?"text-emerald-600 dark:text-emerald-400":"text-light-500"])},[e("span",{class:v(["w-1.5 h-1.5 rounded-full",(((K=n.messages)==null?void 0:K.processing)||0)>0?"bg-emerald-500 animate-pulse":"bg-light-400"])},null,2),R(" "+u((((J=n.messages)==null?void 0:J.processing)||0)>0?"Active":"Idle"),1)],2)]}),_:1},8,["data","loading"]),F(X,{title:"Consumer Groups",columns:ee,data:k.value,loading:f.value,"page-size":5,clickable:"",onRowClick:s[4]||(s[4]=n=>t.$router.push("/consumers"))},{name:z(({value:n})=>[e("span",ht,u(n),1)]),members:z(({value:n})=>[e("span",vt,u(n),1)]),totalLag:z(({value:n})=>[e("span",{class:v(["badge",n>1e3?"badge-danger":n>100?"badge-warning":"badge-success"])},u(A(N)(n||0)),3)]),_:1},8,["data","loading"])])])}}};export{ft as default};
