import{h as p,c as u,l as K,a as d,b as t,d as O,t as a,u as r,f as i,A as w,B as W,C as N,F as z,j as L,k as _,D as C,v as q,E as X,o as c,n as M}from"./index-DukDhp_y.js";const Y={class:"space-y-6 animate-fade-in"},Z={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},tt={class:"card p-4"},et={class:"text-2xl font-bold font-display text-light-900 dark:text-white mt-1"},st={class:"text-xs text-light-500 mt-1"},lt={class:"card p-4"},ot={class:"text-2xl font-bold font-display text-cyber-600 dark:text-cyber-400 mt-1"},at={class:"card p-4"},rt={class:"text-2xl font-bold font-display text-queen-600 dark:text-queen-400 mt-1"},it={class:"card p-4"},nt={class:"text-2xl font-bold font-display text-crown-600 dark:text-crown-400 mt-1"},dt={class:"card p-4"},ct={class:"text-2xl font-bold font-display text-emerald-600 dark:text-emerald-400 mt-1"},pt={class:"card p-4"},ut={class:"flex flex-wrap items-center gap-4"},xt={class:"flex-1 min-w-[200px] max-w-md"},gt={class:"relative"},ht={class:"card overflow-hidden"},mt={class:"overflow-x-auto"},vt={class:"w-full"},kt={key:0},ft={key:1},bt=["onClick"],yt={class:"px-4 py-3"},wt={class:"font-medium text-light-900 dark:text-white hover:text-queen-600 dark:hover:text-queen-400 transition-colors"},_t={class:"px-4 py-3"},Ct={class:"px-4 py-3 text-right text-sm text-light-700 dark:text-light-300"},Mt={class:"px-4 py-3 text-right"},Qt={class:"text-sm font-medium text-cyber-600 dark:text-cyber-400"},jt={class:"px-4 py-3 text-right"},Pt={class:"text-sm font-medium text-crown-600 dark:text-crown-400"},St={class:"px-4 py-3 text-right"},Vt={class:"text-sm text-emerald-600 dark:text-emerald-400"},Bt={class:"px-4 py-3 text-right"},Tt={class:"px-4 py-3 text-right"},$t={class:"text-sm font-semibold text-light-900 dark:text-white"},At={class:"px-4 py-3"},Nt={class:"flex items-center justify-center gap-1"},zt=["onClick"],Lt=["onClick"],qt={key:2},Ft={colspan:"9",class:"px-4 py-12 text-center"},Dt={class:"text-sm text-light-600 dark:text-light-400"},Ut={class:"text-light-600 dark:text-light-400 mb-6"},Et={class:"flex items-center justify-end gap-3"},Rt={__name:"Queues",setup(Ht){const F=X(),n=p([]),b=p(!0),x=p(""),f=p("all"),g=p("name"),h=p(!1),m=p(null),Q=u(()=>{let s=[...n.value];if(x.value){const e=x.value.toLowerCase();s=s.filter(o=>o.name.toLowerCase().includes(e))}return f.value==="active"?s=s.filter(e=>{var o;return(((o=e.messages)==null?void 0:o.processing)||0)>0}):f.value==="idle"&&(s=s.filter(e=>{var o;return(((o=e.messages)==null?void 0:o.processing)||0)===0})),s.sort((e,o)=>{var v,k;if(g.value==="name")return e.name.localeCompare(o.name);const l=((v=e.messages)==null?void 0:v[g.value])||0;return(((k=o.messages)==null?void 0:k[g.value])||0)-l}),s}),D=u(()=>n.value.reduce((s,e)=>{var o;return s+(((o=e.messages)==null?void 0:o.total)||0)},0)),U=u(()=>n.value.reduce((s,e)=>{var o;return s+(((o=e.messages)==null?void 0:o.pending)||0)},0)),E=u(()=>n.value.reduce((s,e)=>{var o;return s+(((o=e.messages)==null?void 0:o.processing)||0)},0)),H=u(()=>n.value.reduce((s,e)=>s+(e.partitions||1),0)),I=u(()=>n.value.filter(s=>{var e;return(((e=s.messages)==null?void 0:e.processing)||0)>0}).length),j=async()=>{var s;b.value=!0;try{const e=await q.list();n.value=((s=e.data)==null?void 0:s.queues)||e.data||[]}catch(e){console.error("Failed to fetch queues:",e)}finally{b.value=!1}},R=s=>{F.push(`/queues/${s.name}`)},G=s=>{m.value=s,h.value=!0},J=async()=>{if(m.value)try{await q.clear(m.value.name),h.value=!1,m.value=null,j()}catch(s){console.error("Failed to clear queue:",s)}};return K(j),(s,e)=>{var o;return c(),d("div",Y,[t("div",Z,[t("div",tt,[e[6]||(e[6]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Total Queues",-1)),t("p",et,a(r(i)(n.value.length)),1),t("p",st,a(r(i)(H.value))+" partitions",1)]),t("div",lt,[e[7]||(e[7]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Total Messages",-1)),t("p",ot,a(r(i)(D.value)),1)]),t("div",at,[e[8]||(e[8]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Pending",-1)),t("p",rt,a(r(i)(U.value)),1)]),t("div",it,[e[9]||(e[9]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Processing",-1)),t("p",nt,a(r(i)(E.value)),1)]),t("div",dt,[e[10]||(e[10]=t("p",{class:"text-xs text-light-500 uppercase tracking-wide"},"Active Queues",-1)),t("p",ct,a(r(i)(I.value)),1)])]),t("div",pt,[t("div",ut,[t("div",xt,[t("div",gt,[w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>x.value=l),type:"text",placeholder:"Search queues...",class:"input pl-10"},null,512),[[W,x.value]]),e[11]||(e[11]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-light-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1))])]),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>f.value=l),class:"select w-40"},[...e[12]||(e[12]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"idle"},"Idle",-1)])],512),[[N,f.value]]),w(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),class:"select w-40"},[...e[13]||(e[13]=[t("option",{value:"name"},"Sort by Name",-1),t("option",{value:"pending"},"Sort by Pending",-1),t("option",{value:"processing"},"Sort by Processing",-1),t("option",{value:"total"},"Sort by Total",-1)])],512),[[N,g.value]])])]),t("div",ht,[t("div",mt,[t("table",vt,[e[19]||(e[19]=t("thead",null,[t("tr",{class:"border-b border-light-200 dark:border-dark-50"},[t("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Queue Name "),t("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Status "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Partitions "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Pending "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Processing "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Completed "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Failed "),t("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Total "),t("th",{class:"text-center px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Actions ")])],-1)),b.value?(c(),d("tbody",kt,[(c(),d(z,null,L(5,l=>t("tr",{key:l,class:"border-b border-light-100 dark:border-dark-100"},[...e[14]||(e[14]=[t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-32"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-5 w-16"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-8 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-12 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-12 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),t("td",{class:"px-4 py-3"},[t("div",{class:"skeleton h-4 w-16 mx-auto"})],-1)])])),64))])):Q.value.length>0?(c(),d("tbody",ft,[(c(!0),d(z,null,L(Q.value,l=>{var y,v,k,P,S,V,B,T,$;return c(),d("tr",{key:l.name,class:"border-b border-light-100 dark:border-dark-100 hover:bg-light-50 dark:hover:bg-dark-300 cursor-pointer transition-colors",onClick:A=>s.$router.push(`/queues/${l.name}`)},[t("td",yt,[t("span",wt,a(l.name),1)]),t("td",_t,[t("span",{class:M(["inline-flex items-center gap-1.5 text-xs font-medium px-2 py-1 rounded-full",(((y=l.messages)==null?void 0:y.processing)||0)>0?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"bg-light-200 dark:bg-dark-200 text-light-600 dark:text-light-400"])},[t("span",{class:M(["w-1.5 h-1.5 rounded-full",(((v=l.messages)==null?void 0:v.processing)||0)>0?"bg-emerald-500 animate-pulse":"bg-light-400"])},null,2),_(" "+a((((k=l.messages)==null?void 0:k.processing)||0)>0?"Active":"Idle"),1)],2)]),t("td",Ct,a(l.partitions||1),1),t("td",Mt,[t("span",Qt,a(r(i)(((P=l.messages)==null?void 0:P.pending)||0)),1)]),t("td",jt,[t("span",Pt,a(r(i)(((S=l.messages)==null?void 0:S.processing)||0)),1)]),t("td",St,[t("span",Vt,a(r(i)(((V=l.messages)==null?void 0:V.completed)||0)),1)]),t("td",Bt,[t("span",{class:M(["text-sm",(((B=l.messages)==null?void 0:B.failed)||0)>0?"text-rose-600 dark:text-rose-400":"text-light-500"])},a(r(i)(((T=l.messages)==null?void 0:T.failed)||0)),3)]),t("td",Tt,[t("span",$t,a(r(i)((($=l.messages)==null?void 0:$.total)||0)),1)]),t("td",At,[t("div",Nt,[t("button",{onClick:C(A=>R(l),["stop"]),class:"p-1.5 rounded hover:bg-light-200 dark:hover:bg-dark-200 text-light-600 dark:text-light-400 hover:text-queen-600 dark:hover:text-queen-400 transition-colors",title:"View details"},[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,zt),t("button",{onClick:C(A=>G(l),["stop"]),class:"p-1.5 rounded hover:bg-rose-100 dark:hover:bg-rose-900/30 text-light-600 dark:text-light-400 hover:text-rose-600 dark:hover:text-rose-400 transition-colors",title:"Clear queue"},[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,Lt)])])],8,bt)}),128))])):(c(),d("tbody",qt,[t("tr",null,[t("td",Ft,[e[17]||(e[17]=t("svg",{class:"w-12 h-12 mx-auto text-light-400 dark:text-light-600 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})],-1)),e[18]||(e[18]=t("h3",{class:"text-sm font-semibold text-light-900 dark:text-white mb-1"},"No queues found",-1)),t("p",Dt,a(x.value?"Try adjusting your search criteria":"Create a queue to get started"),1)])])]))])])]),h.value?(c(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-dark-500/50 backdrop-blur-sm",onClick:e[5]||(e[5]=l=>h.value=!1)},[t("div",{class:"card p-6 w-full max-w-md animate-slide-up",onClick:e[4]||(e[4]=C(()=>{},["stop"]))},[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-light-900 dark:text-white mb-2"}," Clear Queue ",-1)),t("p",Ut,[e[20]||(e[20]=_(" Are you sure you want to clear all messages from ",-1)),t("strong",null,a((o=m.value)==null?void 0:o.name),1),e[21]||(e[21]=_("? This action cannot be undone. ",-1))]),t("div",Et,[t("button",{onClick:e[3]||(e[3]=l=>h.value=!1),class:"btn btn-secondary"}," Cancel "),t("button",{onClick:J,class:"btn bg-rose-600 text-white hover:bg-rose-700"}," Clear Queue ")])])])):O("",!0)])}}};export{Rt as default};
