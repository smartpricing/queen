import{g as d,c as u,k as H,a as n,b as e,d as R,t as a,u as c,A as y,B as G,C as T,F as _,i as C,j,D as V,v as B,E as I,o as r}from"./index-Bh6pUXf_.js";import{f as p}from"./useApi-CMkbhU7m.js";import{u as J}from"./useRefresh-DGHeVgd7.js";const K={class:"space-y-4 sm:space-y-6 animate-fade-in"},O={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-4"},W={class:"card p-3 sm:p-4"},X={class:"text-xl sm:text-2xl font-bold font-display text-light-900 dark:text-white mt-1"},Y={class:"text-[10px] sm:text-xs text-light-500 mt-1"},Z={class:"card p-3 sm:p-4"},tt={class:"text-xl sm:text-2xl font-bold font-display text-cyber-600 dark:text-cyber-400 mt-1"},et={class:"card p-3 sm:p-4"},st={class:"text-xl sm:text-2xl font-bold font-display text-queen-600 dark:text-queen-400 mt-1"},lt={class:"card p-3 sm:p-4"},ot={class:"text-xl sm:text-2xl font-bold font-display text-crown-600 dark:text-crown-400 mt-1"},at={class:"card p-3 sm:p-4 col-span-2 sm:col-span-1"},nt={class:"text-xl sm:text-2xl font-bold font-display text-emerald-600 dark:text-emerald-400 mt-1"},rt={class:"card p-3 sm:p-4"},it={class:"flex flex-col sm:flex-row sm:flex-wrap sm:items-center gap-3 sm:gap-4"},dt={class:"w-full sm:flex-1 sm:min-w-[200px] sm:max-w-md"},ut={class:"relative"},ct=["value"],pt=["value"],xt={class:"card overflow-hidden"},mt={class:"overflow-x-auto"},vt={class:"w-full"},gt={key:0},ht={key:1},kt=["onClick"],ft={class:"px-4 py-3"},wt={class:"font-medium text-light-900 dark:text-white hover:text-queen-600 dark:hover:text-queen-400 transition-colors"},bt={class:"px-4 py-3 text-right text-sm text-light-700 dark:text-light-300"},yt={class:"px-4 py-3 text-right"},_t={class:"text-sm font-medium text-cyber-600 dark:text-cyber-400"},Ct={class:"px-4 py-3 text-right"},Mt={class:"text-sm font-semibold text-light-900 dark:text-white"},Qt={class:"px-4 py-3"},qt={class:"flex items-center justify-center gap-1"},Tt=["onClick"],Vt=["onClick"],jt={key:2},Bt={colspan:"5",class:"px-4 py-12 text-center"},Dt={class:"text-sm text-light-600 dark:text-light-400"},Nt={class:"text-light-600 dark:text-light-400 mb-6"},$t={class:"flex items-center justify-end gap-3"},zt={__name:"Queues",setup(Pt){const D=I(),x=d([]),M=d(!0),m=d(""),v=d(""),g=d(""),h=d("name"),k=d(!1),f=d(null),N=u(()=>[...new Set(x.value.map(t=>t.namespace).filter(t=>t!==void 0))].sort()),$=u(()=>[...new Set(x.value.map(t=>t.task).filter(t=>t!==void 0))].sort()),i=u(()=>{let l=[...x.value];if(m.value){const t=m.value.toLowerCase();l=l.filter(o=>o.name.toLowerCase().includes(t))}return v.value!==""&&(l=l.filter(t=>t.namespace===v.value)),g.value!==""&&(l=l.filter(t=>t.task===g.value)),l.sort((t,o)=>{var w,b;if(h.value==="name")return t.name.localeCompare(o.name);const s=((w=t.messages)==null?void 0:w[h.value])||0;return(((b=o.messages)==null?void 0:b[h.value])||0)-s}),l}),P=u(()=>i.value.reduce((l,t)=>{var o;return l+(((o=t.messages)==null?void 0:o.total)||0)},0)),S=u(()=>i.value.reduce((l,t)=>{var o;return l+(((o=t.messages)==null?void 0:o.pending)||0)},0)),A=u(()=>i.value.reduce((l,t)=>{var o;return l+(((o=t.messages)==null?void 0:o.processing)||0)},0)),L=u(()=>i.value.reduce((l,t)=>l+(t.partitions||1),0)),z=u(()=>i.value.filter(l=>{var t;return(((t=l.messages)==null?void 0:t.processing)||0)>0}).length),Q=async()=>{var l;x.value.length||(M.value=!0);try{const t=await B.list(),o=((l=t.data)==null?void 0:l.queues)||t.data||[];x.value=o.filter(s=>s.name&&s.name.trim()!=="")}catch(t){console.error("Failed to fetch queues:",t)}finally{M.value=!1}},F=l=>{D.push(`/queues/${l.name}`)},U=l=>{f.value=l,k.value=!0},E=async()=>{if(f.value)try{await B.delete(f.value.name),k.value=!1,f.value=null,Q()}catch(l){console.error("Failed to delete queue:",l)}};return J(Q),H(Q),(l,t)=>{var o;return r(),n("div",K,[e("div",O,[e("div",W,[t[7]||(t[7]=e("p",{class:"text-[10px] sm:text-xs text-light-500 uppercase tracking-wide"},"Total Queues",-1)),e("p",X,a(c(p)(i.value.length)),1),e("p",Y,a(c(p)(L.value))+" partitions",1)]),e("div",Z,[t[8]||(t[8]=e("p",{class:"text-[10px] sm:text-xs text-light-500 uppercase tracking-wide"},"Total Messages",-1)),e("p",tt,a(c(p)(P.value)),1)]),e("div",et,[t[9]||(t[9]=e("p",{class:"text-[10px] sm:text-xs text-light-500 uppercase tracking-wide"},"Pending",-1)),e("p",st,a(c(p)(S.value)),1)]),e("div",lt,[t[10]||(t[10]=e("p",{class:"text-[10px] sm:text-xs text-light-500 uppercase tracking-wide"},"Processing",-1)),e("p",ot,a(c(p)(A.value)),1)]),e("div",at,[t[11]||(t[11]=e("p",{class:"text-[10px] sm:text-xs text-light-500 uppercase tracking-wide"},"Active Queues",-1)),e("p",nt,a(c(p)(z.value)),1)])]),e("div",rt,[e("div",it,[e("div",dt,[e("div",ut,[y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),type:"text",placeholder:"Search queues...",class:"input pl-10"},null,512),[[G,m.value]]),t[12]||(t[12]=e("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-light-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1))])]),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),class:"select w-full sm:w-40"},[t[13]||(t[13]=e("option",{value:""},"All Namespaces",-1)),(r(!0),n(_,null,C(N.value,s=>(r(),n("option",{key:s,value:s},a(s||"(empty)"),9,ct))),128))],512),[[T,v.value]]),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>g.value=s),class:"select w-full sm:w-40"},[t[14]||(t[14]=e("option",{value:""},"All Tasks",-1)),(r(!0),n(_,null,C($.value,s=>(r(),n("option",{key:s,value:s},a(s||"(empty)"),9,pt))),128))],512),[[T,g.value]]),y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),class:"select w-full sm:w-40"},[...t[15]||(t[15]=[e("option",{value:"name"},"Sort by Name",-1),e("option",{value:"pending"},"Sort by Pending",-1),e("option",{value:"total"},"Sort by Total",-1)])],512),[[T,h.value]])])]),e("div",xt,[e("div",mt,[e("table",vt,[t[21]||(t[21]=e("thead",null,[e("tr",{class:"border-b border-light-200 dark:border-dark-50"},[e("th",{class:"text-left px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Queue Name "),e("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Partitions "),e("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Pending "),e("th",{class:"text-right px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Total "),e("th",{class:"text-center px-4 py-3 text-xs font-semibold text-light-500 uppercase tracking-wide"}," Actions ")])],-1)),M.value?(r(),n("tbody",gt,[(r(),n(_,null,C(5,s=>e("tr",{key:s,class:"border-b border-light-100 dark:border-dark-100"},[...t[16]||(t[16]=[e("td",{class:"px-4 py-3"},[e("div",{class:"skeleton h-4 w-32"})],-1),e("td",{class:"px-4 py-3"},[e("div",{class:"skeleton h-4 w-8 ml-auto"})],-1),e("td",{class:"px-4 py-3"},[e("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),e("td",{class:"px-4 py-3"},[e("div",{class:"skeleton h-4 w-16 ml-auto"})],-1),e("td",{class:"px-4 py-3"},[e("div",{class:"skeleton h-4 w-16 mx-auto"})],-1)])])),64))])):i.value.length>0?(r(),n("tbody",ht,[(r(!0),n(_,null,C(i.value,s=>{var q,w;return r(),n("tr",{key:s.name,class:"border-b border-light-100 dark:border-dark-100 hover:bg-light-50 dark:hover:bg-dark-300 cursor-pointer transition-colors",onClick:b=>l.$router.push(`/queues/${s.name}`)},[e("td",ft,[e("span",wt,a(s.name),1)]),e("td",bt,a(s.partitions||1),1),e("td",yt,[e("span",_t,a(c(p)(((q=s.messages)==null?void 0:q.pending)||0)),1)]),e("td",Ct,[e("span",Mt,a(c(p)(((w=s.messages)==null?void 0:w.total)||0)),1)]),e("td",Qt,[e("div",qt,[e("button",{onClick:V(b=>F(s),["stop"]),class:"p-1.5 rounded hover:bg-light-200 dark:hover:bg-dark-200 text-light-600 dark:text-light-400 hover:text-queen-600 dark:hover:text-queen-400 transition-colors",title:"View details"},[...t[17]||(t[17]=[e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,Tt),e("button",{onClick:V(b=>U(s),["stop"]),class:"p-1.5 rounded hover:bg-rose-100 dark:hover:bg-rose-900/30 text-light-600 dark:text-light-400 hover:text-rose-600 dark:hover:text-rose-400 transition-colors",title:"Delete queue"},[...t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,Vt)])])],8,kt)}),128))])):(r(),n("tbody",jt,[e("tr",null,[e("td",Bt,[t[19]||(t[19]=e("svg",{class:"w-12 h-12 mx-auto text-light-400 dark:text-light-600 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})],-1)),t[20]||(t[20]=e("h3",{class:"text-sm font-semibold text-light-900 dark:text-white mb-1"},"No queues found",-1)),e("p",Dt,a(m.value||v.value||g.value?"Try adjusting your filters":"Create a queue to get started"),1)])])]))])])]),k.value?(r(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-dark-500/50 backdrop-blur-sm",onClick:t[6]||(t[6]=s=>k.value=!1)},[e("div",{class:"card p-6 w-full max-w-md animate-slide-up",onClick:t[5]||(t[5]=V(()=>{},["stop"]))},[t[24]||(t[24]=e("h3",{class:"text-lg font-semibold text-light-900 dark:text-white mb-2"}," Delete Queue ",-1)),e("p",Nt,[t[22]||(t[22]=j(" Are you sure you want to delete ",-1)),e("strong",null,a((o=f.value)==null?void 0:o.name),1),t[23]||(t[23]=j("? This will permanently remove the queue and all its messages. This action cannot be undone. ",-1))]),e("div",$t,[e("button",{onClick:t[4]||(t[4]=s=>k.value=!1),class:"btn btn-secondary"}," Cancel "),e("button",{onClick:E,class:"btn bg-rose-600 text-white hover:bg-rose-700"}," Delete Queue ")])])])):R("",!0)])}}};export{zt as default};
